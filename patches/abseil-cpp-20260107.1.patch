diff --git a/CMake/AbseilHelpers.cmake b/CMake/AbseilHelpers.cmake
index 61e1ae4..3e6ec94 100644
--- a/CMake/AbseilHelpers.cmake
+++ b/CMake/AbseilHelpers.cmake
@@ -350,7 +350,7 @@ Cflags: -I\${includedir}${PC_CFLAGS}\n")
     endif()
   endif()
 
-  if(ABSL_ENABLE_INSTALL)
+  if(ABSL_ENABLE_INSTALL AND NOT ABSL_CC_LIB_TESTONLY)
     install(TARGETS ${_NAME} EXPORT ${PROJECT_NAME}Targets
           RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
           LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
diff --git a/CMakeLists.txt b/CMakeLists.txt
index 26dc8e7..cd4fef1 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -145,7 +145,7 @@ if((BUILD_TESTING AND ABSL_BUILD_TESTING) OR ABSL_BUILD_TEST_HELPERS)
         add_library(GTest::gmock ALIAS gmock)
         add_library(GTest::gmock_main ALIAS gmock_main)
       else()
-        message(FATAL_ERROR "ABSL_USE_EXTERNAL_GOOGLETEST is ON and ABSL_FIND_GOOGLETEST is OFF, which means that the top-level project must build the Google Test project. However, the target gtest was not found.")
+        message(WARNING "ABSL_USE_EXTERNAL_GOOGLETEST is ON and ABSL_FIND_GOOGLETEST is OFF, which means that the top-level project must build the Google Test project. However, the target gtest was not found.")
       endif()
     endif()
   else()
diff --git a/absl/container/CMakeLists.txt b/absl/container/CMakeLists.txt
index 365c6ea..d12e585 100644
--- a/absl/container/CMakeLists.txt
+++ b/absl/container/CMakeLists.txt
@@ -1119,6 +1119,7 @@ absl_cc_library(
     absl::config
     absl::test_instance_tracker
     GTest::gmock
+  TESTONLY
 )
 
 absl_cc_library(
